"use strict";(self["webpackChunkvue_script"]=self["webpackChunkvue_script"]||[]).push([[608],{4608:(e,a,l)=>{l.r(a),l.d(a,{default:()=>G});var t=l(641),s=l(33),i=l(3751);const n={class:"scan-history-view"},r={class:"filter-card"},c={class:"filter-section"},u={class:"filter-row"},o={class:"filter-row"},d={class:"history-card"},v={class:"history-list"},k={class:"date-container"},f={class:"date-value"},p={class:"time-value"},b={class:"target-container"},g={class:"vuln-summary"},m={key:0,class:"vuln-item critical"},y={class:"vuln-count"},h={key:1,class:"vuln-item high"},L={class:"vuln-count"},_={key:2,class:"vuln-item medium"},w={class:"vuln-count"},F={key:3,class:"vuln-item low"},C={class:"vuln-count"},R={class:"action-buttons"},S={class:"pagination-section"},V={key:0,class:"tech-detail-container"},E={class:"vulnerability-section"},W={class:"section-title"},D={class:"vuln-count"},X={class:"vuln-list"},U={class:"vuln-header"},z={class:"vuln-title"},K={class:"vuln-id"},Q={class:"vuln-name"},x={class:"vuln-actions"},T={class:"vuln-content"},$={class:"vuln-description"},j={class:"vuln-info-grid"},H={class:"info-item"},I={class:"info-item"},P={key:0,class:"vuln-location"},Y={key:1,class:"vuln-request"},q={class:"dialog-footer"};function O(e,a,l,O,M,A){const B=(0,t.g2)("el-input"),J=(0,t.g2)("el-form-item"),N=(0,t.g2)("el-date-picker"),G=(0,t.g2)("el-option"),Z=(0,t.g2)("el-select"),ee=(0,t.g2)("el-button"),ae=(0,t.g2)("el-form"),le=(0,t.g2)("el-table-column"),te=(0,t.g2)("el-tag"),se=(0,t.g2)("el-table"),ie=(0,t.g2)("el-pagination"),ne=(0,t.g2)("el-tooltip"),re=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)("div",n,[a[24]||(a[24]=(0,t.Fv)('<div class="header-section" data-v-6e8c0afb><div class="header-content" data-v-6e8c0afb><div class="title-container" data-v-6e8c0afb><i class="fas fa-history" data-v-6e8c0afb></i><h1 data-v-6e8c0afb>扫描历史记录</h1></div><p class="subtitle" data-v-6e8c0afb>查看和管理扫描历史记录，分析漏洞技术细节</p></div><div class="header-decoration" data-v-6e8c0afb><div class="decoration-item" data-v-6e8c0afb></div><div class="decoration-item" data-v-6e8c0afb></div><div class="decoration-item" data-v-6e8c0afb></div></div></div>',1)),(0,t.Lk)("div",r,[(0,t.Lk)("div",c,[(0,t.bF)(ae,{inline:!0,model:O.filterForm},{default:(0,t.k6)((()=>[(0,t.Lk)("div",u,[(0,t.bF)(J,{label:"扫描目标"},{default:(0,t.k6)((()=>[(0,t.bF)(B,{modelValue:O.filterForm.target,"onUpdate:modelValue":a[0]||(a[0]=e=>O.filterForm.target=e),placeholder:"输入URL或关键词",class:"filter-input"},{prefix:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.Lk)("i",{class:"fas fa-bullseye"},null,-1)]))),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(J,{label:"日期范围"},{default:(0,t.k6)((()=>[(0,t.bF)(N,{modelValue:O.filterForm.dateRange,"onUpdate:modelValue":a[1]||(a[1]=e=>O.filterForm.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",class:"filter-date-picker"},{prefix:(0,t.k6)((()=>a[6]||(a[6]=[(0,t.Lk)("i",{class:"fas fa-calendar"},null,-1)]))),_:1},8,["modelValue"])])),_:1})]),(0,t.Lk)("div",o,[(0,t.bF)(J,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(Z,{modelValue:O.filterForm.status,"onUpdate:modelValue":a[2]||(a[2]=e=>O.filterForm.status=e),placeholder:"选择状态",class:"filter-select"},{default:(0,t.k6)((()=>[(0,t.bF)(G,{label:"全部",value:""}),(0,t.bF)(G,{label:"已完成",value:"completed"}),(0,t.bF)(G,{label:"失败",value:"failed"}),(0,t.bF)(G,{label:"进行中",value:"scanning"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(J,null,{default:(0,t.k6)((()=>[(0,t.bF)(ee,{type:"primary",onClick:O.searchHistory,class:"filter-button primary"},{default:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.Lk)("i",{class:"fas fa-search"},null,-1),(0,t.eW)(" 搜索 ")]))),_:1,__:[7]},8,["onClick"]),(0,t.bF)(ee,{onClick:O.resetFilter,class:"filter-button secondary"},{default:(0,t.k6)((()=>a[8]||(a[8]=[(0,t.Lk)("i",{class:"fas fa-undo"},null,-1),(0,t.eW)(" 重置 ")]))),_:1,__:[8]},8,["onClick"])])),_:1})])])),_:1},8,["model"])])]),(0,t.Lk)("div",d,[(0,t.Lk)("div",v,[(0,t.bF)(se,{data:O.filteredHistory,style:{width:"100%"},class:"scan-history-table","row-class-name":"scan-row","header-row-class-name":"header-row",onRowClick:O.handleRowClick},{default:(0,t.k6)((()=>[(0,t.bF)(le,{prop:"date",label:"扫描日期",width:"180"},{default:(0,t.k6)((({row:e})=>[(0,t.Lk)("div",k,[(0,t.Lk)("div",f,(0,s.v_)(e.date),1),(0,t.Lk)("div",p,(0,s.v_)(e.time),1)])])),_:1}),(0,t.bF)(le,{prop:"target",label:"扫描目标"},{default:(0,t.k6)((({row:e})=>[(0,t.Lk)("div",b,[(0,t.Lk)("i",{class:(0,s.C4)(["fas","web"===e.type?"fa-globe":"fa-file-code"])},null,2),(0,t.Lk)("span",null,(0,s.v_)(e.target),1)])])),_:1}),(0,t.bF)(le,{prop:"type",label:"扫描类型",width:"120"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(te,{type:"web"===e.type?"success":"info",class:"scan-type-tag",effect:"dark",round:""},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)("web"===e.type?"Web扫描":"二进制扫描"),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(le,{label:"结果概要",width:"180"},{default:(0,t.k6)((({row:e})=>[(0,t.Lk)("div",g,[e.vulnSummary.critical>0?((0,t.uX)(),(0,t.CE)("div",m,[(0,t.Lk)("span",y,(0,s.v_)(e.vulnSummary.critical),1),a[9]||(a[9]=(0,t.Lk)("span",{class:"vuln-label"},"严重",-1))])):(0,t.Q3)("",!0),e.vulnSummary.high>0?((0,t.uX)(),(0,t.CE)("div",h,[(0,t.Lk)("span",L,(0,s.v_)(e.vulnSummary.high),1),a[10]||(a[10]=(0,t.Lk)("span",{class:"vuln-label"},"高危",-1))])):(0,t.Q3)("",!0),e.vulnSummary.medium>0?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.Lk)("span",w,(0,s.v_)(e.vulnSummary.medium),1),a[11]||(a[11]=(0,t.Lk)("span",{class:"vuln-label"},"中危",-1))])):(0,t.Q3)("",!0),e.vulnSummary.low>0?((0,t.uX)(),(0,t.CE)("div",F,[(0,t.Lk)("span",C,(0,s.v_)(e.vulnSummary.low),1),a[12]||(a[12]=(0,t.Lk)("span",{class:"vuln-label"},"低危",-1))])):(0,t.Q3)("",!0)])])),_:1}),(0,t.bF)(le,{label:"操作",width:"240",fixed:"right"},{default:(0,t.k6)((({row:e})=>[(0,t.Lk)("div",R,[(0,t.bF)(ee,{size:"small",class:"action-button tech-details",onClick:(0,i.D$)((a=>O.viewTechnicalDetails(e)),["stop"])},{default:(0,t.k6)((()=>a[13]||(a[13]=[(0,t.Lk)("i",{class:"fas fa-search"},null,-1),(0,t.eW)(" 技术细节 ")]))),_:2,__:[13]},1032,["onClick"]),(0,t.bF)(ee,{size:"small",type:"primary",class:"action-button generate-report",onClick:(0,i.D$)((a=>O.generateReport(e)),["stop"])},{default:(0,t.k6)((()=>a[14]||(a[14]=[(0,t.Lk)("i",{class:"fas fa-file-pdf"},null,-1),(0,t.eW)(" 生成报告 ")]))),_:2,__:[14]},1032,["onClick"])])])),_:1})])),_:1},8,["data","onRowClick"]),(0,t.Lk)("div",S,[(0,t.bF)(ie,{background:"",layout:"prev, pager, next, jumper",total:O.totalItems,"page-size":O.pageSize,"current-page":O.currentPage,onCurrentChange:O.handlePageChange,class:"history-pagination"},null,8,["total","page-size","current-page","onCurrentChange"])])])]),(0,t.bF)(re,{modelValue:O.detailDialogVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>O.detailDialogVisible=e),title:`扫描技术细节 - ${O.currentScan?O.currentScan.target:""}`,width:"85%",top:"5vh","custom-class":"tech-detail-dialog"},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",q,[(0,t.bF)(ee,{onClick:a[3]||(a[3]=e=>O.detailDialogVisible=!1)},{default:(0,t.k6)((()=>a[23]||(a[23]=[(0,t.eW)("关闭")]))),_:1,__:[23]})])])),default:(0,t.k6)((()=>[O.currentScan?((0,t.uX)(),(0,t.CE)("div",V,[(0,t.Lk)("div",E,[(0,t.Lk)("h3",W,[a[15]||(a[15]=(0,t.Lk)("i",{class:"fas fa-bug"},null,-1)),a[16]||(a[16]=(0,t.eW)(" 漏洞列表 ")),(0,t.Lk)("span",D,"(共 "+(0,s.v_)(O.currentScan.vulnerabilities.length)+" 个漏洞)",1)]),(0,t.Lk)("div",X,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(O.currentScan.vulnerabilities,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,s.C4)(["vuln-item",e.severity])},[(0,t.Lk)("div",U,[(0,t.Lk)("div",z,[(0,t.Lk)("span",K,(0,s.v_)(e.id),1),(0,t.Lk)("span",Q,(0,s.v_)(e.name),1),(0,t.bF)(te,{type:O.getSeverityTagType(e.severity),size:"small",effect:"dark",class:"severity-tag"},{default:(0,t.k6)((()=>[(0,t.eW)((0,s.v_)(O.getSeverityLabel(e.severity)),1)])),_:2},1032,["type"])]),(0,t.Lk)("div",x,[(0,t.bF)(ne,{effect:"dark",content:"导出详情",placement:"top"},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{circle:"",size:"small",onClick:a=>O.exportVulnerability(e)},{default:(0,t.k6)((()=>a[17]||(a[17]=[(0,t.Lk)("i",{class:"fas fa-download"},null,-1)]))),_:2,__:[17]},1032,["onClick"])])),_:2},1024)])]),(0,t.Lk)("div",T,[(0,t.Lk)("div",$,[a[18]||(a[18]=(0,t.Lk)("label",null,"详细描述:",-1)),(0,t.Lk)("p",null,(0,s.v_)(e.description),1)]),(0,t.Lk)("div",j,[(0,t.Lk)("div",H,[a[19]||(a[19]=(0,t.Lk)("label",null,"风险等级:",-1)),(0,t.Lk)("span",{class:(0,s.C4)("risk-level "+e.severity)},(0,s.v_)(O.getSeverityLevel(e.severity)),3)]),(0,t.Lk)("div",I,[a[20]||(a[20]=(0,t.Lk)("label",null,"发现时间:",-1)),(0,t.Lk)("span",null,(0,s.v_)(O.currentScan.time),1)])]),e.location?((0,t.uX)(),(0,t.CE)("div",P,[a[21]||(a[21]=(0,t.Lk)("label",null,"漏洞位置:",-1)),(0,t.Lk)("pre",null,(0,s.v_)(e.location),1)])):(0,t.Q3)("",!0),e.request?((0,t.uX)(),(0,t.CE)("div",Y,[a[22]||(a[22]=(0,t.Lk)("label",null,"请求示例:",-1)),(0,t.Lk)("pre",null,(0,s.v_)(e.request),1)])):(0,t.Q3)("",!0)])],2)))),128))])])])):(0,t.Q3)("",!0)])),_:1},8,["modelValue","title"])])}var M=l(953),A=l(163);const B={setup(){const e=(0,M.KR)([]),a=(0,M.KR)(!0),s=()=>{try{a.value=!0;const t=l(5961);e.value=t.keys().map((e=>t(e))).sort(((e,a)=>a.id.localeCompare(e.id)))}catch(t){console.error(t),A.nk.error("加载扫描记录失败")}finally{a.value=!1}};(0,t.sV)((()=>{s()}));const i=(0,M.Kh)({target:"",dateRange:[],status:""}),n=(0,M.KR)(1),r=(0,M.KR)(5),c=(0,t.EW)((()=>e.value.length)),u=(0,t.EW)((()=>e.value.filter((e=>{const a=!i.target||e.target.toLowerCase().includes(i.target.toLowerCase()),l=2!==i.dateRange.length||e.date>=i.dateRange[0]&&e.date<=i.dateRange[1],t=!i.status||e.status===i.status;return a&&l&&t})).slice((n.value-1)*r.value,n.value*r.value))),o=()=>{n.value=1},d=()=>{i.target="",i.dateRange=[],i.status="",n.value=1},v=e=>{n.value=e},k=(0,M.KR)(!1),f=(0,M.KR)(null),p=e=>{switch(e){case"critical":return"danger";case"high":return"warning";case"medium":return"primary";case"low":return"success";default:return"info"}},b=e=>{switch(e){case"critical":return"严重";case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},g=e=>{switch(e){case"critical":return"极高风险";case"high":return"高风险";case"medium":return"中等风险";case"low":return"低风险";default:return"未知风险"}},m=e=>{f.value={...e},k.value=!0},y=e=>{A.nk.success(`正在生成 ${e.target} 的扫描报告...`)},h=e=>{console.log("点击行:",e.id)},L=e=>{const a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`${e.id}.json`,t.click(),URL.revokeObjectURL(l),A.nk.success(`${e.id} 已导出`)};return{filterForm:i,filteredHistory:u,totalItems:c,pageSize:r,currentPage:n,searchHistory:o,resetFilter:d,handlePageChange:v,viewTechnicalDetails:m,generateReport:y,handleRowClick:h,detailDialogVisible:k,currentScan:f,getSeverityTagType:p,getSeverityLabel:b,getSeverityLevel:g,loading:a,exportVulnerability:L}}};var J=l(6262);const N=(0,J.A)(B,[["render",O],["__scopeId","data-v-6e8c0afb"]]),G=N}}]);
//# sourceMappingURL=608.0eb0b574.js.map