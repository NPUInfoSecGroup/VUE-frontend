(()=>{var t={2160:t=>{"use strict";t.exports=JSON.parse('{"id":"scan-2023091401","date":"2023-09-14","time":"10:15:45","target":"file:app_v1.2.0.exe","type":"binary","status":"completed","vulnSummary":{"critical":0,"high":2,"medium":5,"low":8},"vulnerabilities":[{"id":"vuln-101","name":"缓冲区溢出漏洞","severity":"high","description":"在文件解析模块发现缓冲区溢出漏洞"},{"id":"vuln-102","name":"权限提升漏洞","severity":"medium","description":"在服务管理模块发现权限提升漏洞"}]}')},4379:t=>{"use strict";t.exports=JSON.parse('{"id":"scan-2023091501","date":"2023-09-15","time":"14:30:22","target":"https://example.com","type":"web","status":"completed","vulnSummary":{"critical":3,"high":7,"medium":12,"low":5},"vulnerabilities":[{"id":"vuln-001","name":"SQL注入漏洞","severity":"critical","description":"在登录接口发现SQL注入漏洞"},{"id":"vuln-002","name":"XSS跨站脚本","severity":"high","description":"在用户反馈表单中发现存储型XSS漏洞"}]}')},5961:(t,e,a)=>{var s={"./scan-2023091401.json":2160,"./scan-2023091501.json":4379};function n(t){var e=o(t);return a(e)}function o(t){if(!a.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}n.keys=function(){return Object.keys(s)},n.resolve=o,t.exports=n,n.id=5961},6296:(t,e,a)=>{"use strict";var s=a(3751),n=a(641);const o={id:"app"};function r(t,e,a,s,r,l){const i=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(i)])}const l={name:"App",setup(){function t(){const t=document.getElementById("particle-canvas");t&&(t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.zIndex="-1")}(0,n.sV)((()=>{t()}))}};var i=a(6262);const c=(0,i.A)(l,[["render",r]]),u=c;var d=a(5220);const p={class:"dashboard-container"},v={class:"app-header"},m={class:"nav-buttons"},h={class:"dashboard-content"},g={class:"module-wrapper target-area"},k={class:"module-wrapper status-area"},L={class:"module-wrapper report-area"};function f(t,e,a,s,o,r){const l=(0,n.g2)("router-link"),i=(0,n.g2)("ScanTarget"),c=(0,n.g2)("ScanStatus"),u=(0,n.g2)("ReportGenerator");return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("header",v,[e[3]||(e[3]=(0,n.Lk)("div",{class:"header-content"},[(0,n.Lk)("h1",{class:"app-title"},[(0,n.Lk)("i",{class:"fas fa-shield-alt"}),(0,n.eW)(" 漏洞扫描系统 ")]),(0,n.Lk)("p",{class:"app-subtitle"}," 基于 Vue.js 构建的企业级安全扫描平台 - 全面保障您的网络安全 ")],-1)),(0,n.Lk)("nav",m,[(0,n.bF)(l,{to:"/dashboard",class:"nav-button"},{default:(0,n.k6)((()=>e[0]||(e[0]=[(0,n.Lk)("i",{class:"fas fa-home"},null,-1),(0,n.eW)(" 主页 ")]))),_:1,__:[0]}),(0,n.bF)(l,{to:"/scan-history",class:"nav-button"},{default:(0,n.k6)((()=>e[1]||(e[1]=[(0,n.Lk)("i",{class:"fas fa-history"},null,-1),(0,n.eW)(" 扫描历史 ")]))),_:1,__:[1]}),(0,n.bF)(l,{to:"/report-templates",class:"nav-button"},{default:(0,n.k6)((()=>e[2]||(e[2]=[(0,n.Lk)("i",{class:"fas fa-file-alt"},null,-1),(0,n.eW)(" 报告模板 ")]))),_:1,__:[2]})])]),(0,n.Lk)("main",h,[(0,n.Lk)("div",g,[(0,n.bF)(i)]),(0,n.Lk)("div",k,[(0,n.bF)(c)]),(0,n.Lk)("div",L,[(0,n.bF)(u)])])])}var y=a(33);const S={class:"scan-target card"},b={class:"card-body"},T={class:"section"},C={class:"form-group"},_={class:"form-group"},E={class:"section"},x={class:"form-group"},R={class:"tools-grid"},w=["id","value"],O=["for"],A={class:"section"},D={class:"form-group"},N={class:"actions"};function P(t,e,a,o,r,l){return(0,n.uX)(),(0,n.CE)("div",S,[e[15]||(e[15]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("i",{class:"fas fa-bullseye"}),(0,n.Lk)("h2",null,"扫描目标配置")],-1)),(0,n.Lk)("div",b,[(0,n.Lk)("div",T,[e[8]||(e[8]=(0,n.Lk)("div",{class:"section-title"},[(0,n.Lk)("i",{class:"fas fa-globe-americas"}),(0,n.Lk)("span",null,"目标配置")],-1)),(0,n.Lk)("div",C,[e[6]||(e[6]=(0,n.Lk)("label",{class:"form-label",for:"url"},"目标 URL：",-1)),(0,n.bo)((0,n.Lk)("input",{id:"url","onUpdate:modelValue":e[0]||(e[0]=t=>r.targetUrl=t),type:"text",placeholder:"https://example.com",class:"form-input"},null,512),[[s.Jo,r.targetUrl]])]),(0,n.Lk)("div",_,[e[7]||(e[7]=(0,n.Lk)("label",{class:"form-label",for:"ipRange"},"IP 范围：",-1)),(0,n.bo)((0,n.Lk)("input",{id:"ipRange","onUpdate:modelValue":e[1]||(e[1]=t=>r.ipRange=t),type:"text",placeholder:"192.168.1.1-192.168.1.255",class:"form-input"},null,512),[[s.Jo,r.ipRange]])])]),(0,n.Lk)("div",E,[e[10]||(e[10]=(0,n.Lk)("div",{class:"section-title"},[(0,n.Lk)("i",{class:"fas fa-tools"}),(0,n.Lk)("span",null,"扫描工具配置")],-1)),(0,n.Lk)("div",x,[e[9]||(e[9]=(0,n.Lk)("label",{class:"form-label"},"选择工具：",-1)),(0,n.Lk)("div",R,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.availableTools,((t,a)=>((0,n.uX)(),(0,n.CE)("div",{key:a,class:"tool-option"},[(0,n.bo)((0,n.Lk)("input",{type:"checkbox",id:"tool-"+a,value:t,"onUpdate:modelValue":e[2]||(e[2]=t=>r.selectedTools=t),class:"tool-checkbox"},null,8,w),[[s.lH,r.selectedTools]]),(0,n.Lk)("label",{for:"tool-"+a},(0,y.v_)(t),9,O)])))),128))])])]),(0,n.Lk)("div",A,[e[12]||(e[12]=(0,n.Lk)("div",{class:"section-title"},[(0,n.Lk)("i",{class:"fas fa-comment-alt"}),(0,n.Lk)("span",null,"扫描建议")],-1)),(0,n.Lk)("div",D,[e[11]||(e[11]=(0,n.Lk)("label",{class:"form-label",for:"suggestions"},"额外参数或建议：",-1)),(0,n.bo)((0,n.Lk)("textarea",{id:"suggestions","onUpdate:modelValue":e[3]||(e[3]=t=>r.suggestions=t),placeholder:"请输入特定的扫描要求或建议...",class:"form-textarea"},null,512),[[s.Jo,r.suggestions]])])]),(0,n.Lk)("div",N,[(0,n.Lk)("button",{class:"action-btn primary",onClick:e[4]||(e[4]=(...t)=>l.startScan&&l.startScan(...t))},e[13]||(e[13]=[(0,n.Lk)("i",{class:"fas fa-play"},null,-1),(0,n.eW)(" 启动扫描 ")])),(0,n.Lk)("button",{class:"action-btn secondary",onClick:e[5]||(e[5]=(...t)=>l.resetForm&&l.resetForm(...t))},e[14]||(e[14]=[(0,n.Lk)("i",{class:"fas fa-redo"},null,-1),(0,n.eW)(" 重置 ")]))])])])}const I={name:"ScanTarget",data(){return{targetUrl:"",ipRange:"",availableTools:["fenjing","fscan","dirsearch","curl","githack","ds_store_exp","gotoscan","SQLMap","xss"],selectedTools:[],suggestions:""}},methods:{startScan(){this.targetUrl||this.ipRange?0!==this.selectedTools.length?(console.log("开始扫描配置：",{targetUrl:this.targetUrl,ipRange:this.ipRange,tools:this.selectedTools,suggestions:this.suggestions}),alert(`扫描已启动！使用工具：${this.selectedTools.join(", ")}`)):alert("请至少选择一个扫描工具"):alert("请至少输入一个目标URL或IP范围")},resetForm(){this.targetUrl="",this.ipRange="",this.selectedTools=[],this.suggestions=""}}},U=(0,i.A)(I,[["render",P],["__scopeId","data-v-69a006c3"]]),j=U,F={class:"scan-output card"},X={class:"card-header"},M={class:"header-controls"},Q=["title"],W={class:"card-body"},V={class:"output-timestamp"},H={key:0,class:"tool-tag"},K={key:1,class:"command-prompt"},B={key:0,class:"loading-indicator"},$={class:"card-footer"},G={class:"status-indicator"},J={class:"status-text"},q={class:"tool-usage"};function z(t,e,a,s,o,r){return(0,n.uX)(),(0,n.CE)("div",F,[(0,n.Lk)("div",X,[e[6]||(e[6]=(0,n.Lk)("i",{class:"fas fa-terminal"},null,-1)),e[7]||(e[7]=(0,n.Lk)("h2",null,"扫描命令输出",-1)),(0,n.Lk)("div",M,[(0,n.Lk)("button",{class:"control-btn",onClick:e[0]||(e[0]=(...t)=>r.clearOutput&&r.clearOutput(...t)),title:"清空输出"},e[4]||(e[4]=[(0,n.Lk)("i",{class:"fas fa-trash"},null,-1)])),(0,n.Lk)("button",{class:"control-btn",onClick:e[1]||(e[1]=(...t)=>r.toggleAutoScroll&&r.toggleAutoScroll(...t)),title:o.autoScroll?"停止自动滚动":"启用自动滚动"},[(0,n.Lk)("i",{class:(0,y.C4)(["fas",o.autoScroll?"fa-pause":"fa-play"])},null,2)],8,Q),(0,n.Lk)("button",{class:"control-btn",onClick:e[2]||(e[2]=(...t)=>r.copyOutput&&r.copyOutput(...t)),title:"复制输出"},e[5]||(e[5]=[(0,n.Lk)("i",{class:"fas fa-copy"},null,-1)]))])]),(0,n.Lk)("div",W,[(0,n.Lk)("div",{ref:"outputContainer",class:"cli-output",onScroll:e[3]||(e[3]=(...t)=>r.handleScroll&&r.handleScroll(...t))},[(0,n.Lk)("div",V,"命令回显开始 "+(0,y.v_)(o.startTime),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.outputLines,((t,e)=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:(0,y.C4)(["output-line",t.type])},[t.tool?((0,n.uX)(),(0,n.CE)("span",H,(0,y.v_)(t.tool),1)):(0,n.Q3)("",!0),(0,n.Lk)("span",{class:(0,y.C4)(["line-content",t.type])},(0,y.v_)(t.content),3),"command"===t.type?((0,n.uX)(),(0,n.CE)("span",K,"$")):(0,n.Q3)("",!0)],2)))),128)),o.isLoading?((0,n.uX)(),(0,n.CE)("div",B,e[8]||(e[8]=[(0,n.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,n.eW)(" 扫描进行中... ")]))):(0,n.Q3)("",!0)],544)]),(0,n.Lk)("div",$,[(0,n.Lk)("div",G,[(0,n.Lk)("div",{class:(0,y.C4)(["status-bubble",r.statusClass])},null,2),(0,n.Lk)("div",J,(0,y.v_)(r.statusText),1)]),(0,n.Lk)("div",q,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.activeTools,(t=>((0,n.uX)(),(0,n.CE)("span",{key:t,class:"tool-chip"},[e[9]||(e[9]=(0,n.Lk)("i",{class:"fas fa-toolbox"},null,-1)),(0,n.eW)(" "+(0,y.v_)(t),1)])))),128))])])])}const Z={name:"ScanOutput",data(){return{outputLines:[],startTime:(new Date).toLocaleTimeString(),autoScroll:!0,isLoading:!0,status:"running",activeTools:["SQLMap","dirsearch","fscan"],scrollPosition:0}},computed:{statusText(){return"ready"===this.status?"就绪，等待扫描开始":"扫描进行中…"},statusClass(){return"ready"===this.status?"ready":"running"}},methods:{addOutputLine(t,e,a){this.outputLines.push({type:t,content:e,tool:a,timestamp:(new Date).toLocaleTimeString()}),this.autoScroll&&this.$nextTick((()=>{this.scrollToBottom()}))},addCommand(t){this.addOutputLine("command",t)},addResponse(t){this.addOutputLine("response",t)},addSuccess(t){this.addOutputLine("success",t)},addError(t){this.addOutputLine("error",t)},addToolOutput(t,e){this.addOutputLine("tool-output",e,t)},scrollToBottom(){const t=this.$refs.outputContainer;t.scrollTop=t.scrollHeight},clearOutput(){this.outputLines=[],this.startTime=(new Date).toLocaleTimeString(),this.addOutputLine("info","输出已清空")},toggleAutoScroll(){this.autoScroll=!this.autoScroll,this.autoScroll&&this.scrollToBottom()},copyOutput(){const t=this.outputLines.map((t=>{const e=t.tool?`[${t.tool}] `:"";return e+t.content})).join("\n");navigator.clipboard.writeText(t).then((()=>{this.addOutputLine("success","输出已复制到剪贴板")})).catch((t=>{this.addOutputLine("error","复制失败: "+t.message)}))},handleScroll(){const t=this.$refs.outputContainer,e=t.scrollHeight-t.scrollTop===t.clientHeight;this.autoScroll=!!e},simulateScanOutput(){const t=[{type:"command",text:"scan --target https://example.com"},{type:"info",text:"Starting vulnerability scan..."},{type:"tool-output",text:"Initializing SQLMap v1.6",tool:"SQLMap"},{type:"tool-output",text:"Target URL: https://example.com/login.php",tool:"SQLMap"},{type:"tool-output",text:"Payload: 1 AND 1=1 UNION ALL SELECT 1,NULL...",tool:"SQLMap"},{type:"success",text:"SQLMap: Potential SQL injection detected"},{type:"tool-output",text:"Launching directory brute-force with dirsearch",tool:"dirsearch"},{type:"tool-output",text:"Status 200: /admin",tool:"dirsearch"},{type:"tool-output",text:"Status 200: /backup",tool:"dirsearch"},{type:"tool-output",text:"Status 403: /wp-admin",tool:"dirsearch"},{type:"tool-output",text:"Running network scan with fscan",tool:"fscan"},{type:"tool-output",text:"Port 80/tcp open  http",tool:"fscan"},{type:"tool-output",text:"Port 443/tcp open  ssl/http",tool:"fscan"},{type:"tool-output",text:"Port 8080/tcp open  http-proxy",tool:"fscan"},{type:"tool-output",text:"Cloning .git repository with githack",tool:"githack"},{type:"tool-output",text:"Found .git directory at https://example.com/.git/",tool:"githack"},{type:"success",text:"Scan completed - 3 vulnerabilities found"}];let e=0;const a=setInterval((()=>{if(e>=t.length)return clearInterval(a),this.isLoading=!1,this.status="ready",void this.addOutputLine("success","所有扫描任务已完成");const s=t[e];switch(s.type){case"command":this.addCommand(s.text);break;case"info":this.addOutputLine("info",s.text);break;case"success":this.addSuccess(s.text);break;case"tool-output":this.addToolOutput(s.tool,s.text);break}e++}),400)}},mounted(){this.simulateScanOutput()}},Y=(0,i.A)(Z,[["render",z],["__scopeId","data-v-3007ac86"]]),tt=Y,et={class:"report-generator card"},at={class:"card-body"},st={class:"report-actions"},nt={class:"select-row"},ot=["value"],rt={class:"select-row"},lt=["value"],it={class:"report-preview"},ct={class:"report-metadata"},ut={class:"metadata-column"},dt={class:"metadata-column"},pt={class:"vulnerability-stats"},vt={class:"stat-card critical"},mt={class:"stat-value"},ht={class:"stat-card high"},gt={class:"stat-value"},kt={class:"stat-card medium"},Lt={class:"stat-value"},ft={class:"stat-card low"},yt={class:"stat-value"},St={class:"report-section"},bt={class:"summary-detail"};function Tt(t,e,a,o,r,l){return(0,n.uX)(),(0,n.CE)("div",et,[e[26]||(e[26]=(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("i",{class:"fas fa-file-alt"}),(0,n.Lk)("h2",null,"报告生成")],-1)),(0,n.Lk)("div",at,[(0,n.Lk)("div",st,[(0,n.Lk)("button",{class:"action-button generate",onClick:e[0]||(e[0]=(...t)=>o.generateReport&&o.generateReport(...t))},e[6]||(e[6]=[(0,n.Lk)("i",{class:"fas fa-sync-alt"},null,-1),(0,n.Lk)("span",null,"生成报告",-1)])),(0,n.Lk)("button",{class:"action-button save",onClick:e[1]||(e[1]=(...t)=>o.saveReport&&o.saveReport(...t))},e[7]||(e[7]=[(0,n.Lk)("i",{class:"fas fa-save"},null,-1),(0,n.Lk)("span",null,"保存报告",-1)])),(0,n.Lk)("button",{class:"action-button export",onClick:e[2]||(e[2]=(...t)=>o.exportReport&&o.exportReport(...t))},e[8]||(e[8]=[(0,n.Lk)("i",{class:"fas fa-file-export"},null,-1),(0,n.Lk)("span",null,"导出报告",-1)])),(0,n.Lk)("button",{class:"action-button share",onClick:e[3]||(e[3]=(...t)=>o.shareReport&&o.shareReport(...t))},e[9]||(e[9]=[(0,n.Lk)("i",{class:"fas fa-share-alt"},null,-1),(0,n.Lk)("span",null,"分享报告",-1)]))]),(0,n.Lk)("div",nt,[e[10]||(e[10]=(0,n.Lk)("div",{class:"select-label"},"报告模板：",-1)),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.selectedReportTemplate=t),class:"select-input"},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.reportTemplates,(t=>((0,n.uX)(),(0,n.CE)("option",{key:t.id,value:t.value},(0,y.v_)(t.name),9,ot)))),128))],512),[[s.u1,o.selectedReportTemplate]])]),(0,n.Lk)("div",rt,[e[11]||(e[11]=(0,n.Lk)("div",{class:"select-label"},"扫描记录：",-1)),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>o.selectedRecordId=t),class:"select-input"},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.scanHistory,(t=>((0,n.uX)(),(0,n.CE)("option",{key:t.id,value:t.id},(0,y.v_)(t.date)+" - "+(0,y.v_)(t.id),9,lt)))),128))],512),[[s.u1,o.selectedRecordId]])]),(0,n.Lk)("div",it,[e[25]||(e[25]=(0,n.Lk)("div",{class:"report-header"},[(0,n.Lk)("h3",null,"安全扫描报告"),(0,n.Lk)("p",null,"漏洞挖掘与验证系统生成")],-1)),(0,n.Lk)("div",ct,[(0,n.Lk)("div",ut,[(0,n.Lk)("p",null,[e[12]||(e[12]=(0,n.Lk)("strong",null,"报告日期:",-1)),(0,n.eW)(" "+(0,y.v_)(o.currentDate),1)]),(0,n.Lk)("p",null,[e[13]||(e[13]=(0,n.Lk)("strong",null,"扫描类型:",-1)),(0,n.eW)(" "+(0,y.v_)(t.scanType),1)])]),(0,n.Lk)("div",dt,[(0,n.Lk)("p",null,[e[14]||(e[14]=(0,n.Lk)("strong",null,"生成者:",-1)),(0,n.eW)(" "+(0,y.v_)(o.reporterName),1)]),e[15]||(e[15]=(0,n.Lk)("p",null,[(0,n.Lk)("strong",null,"版本:"),(0,n.eW)(" 1.0.0")],-1))])]),(0,n.Lk)("div",pt,[(0,n.Lk)("div",vt,[e[16]||(e[16]=(0,n.Lk)("div",{class:"stat-title"},"严重漏洞",-1)),(0,n.Lk)("div",mt,(0,y.v_)(o.generatedReport.vulnCount.critical),1)]),(0,n.Lk)("div",ht,[e[17]||(e[17]=(0,n.Lk)("div",{class:"stat-title"},"高危漏洞",-1)),(0,n.Lk)("div",gt,(0,y.v_)(o.generatedReport.vulnCount.high),1)]),(0,n.Lk)("div",kt,[e[18]||(e[18]=(0,n.Lk)("div",{class:"stat-title"},"中危漏洞",-1)),(0,n.Lk)("div",Lt,(0,y.v_)(o.generatedReport.vulnCount.medium),1)]),(0,n.Lk)("div",ft,[e[19]||(e[19]=(0,n.Lk)("div",{class:"stat-title"},"低危漏洞",-1)),(0,n.Lk)("div",yt,(0,y.v_)(o.generatedReport.vulnCount.low),1)])]),(0,n.Lk)("div",St,[e[24]||(e[24]=(0,n.Lk)("h4",null,"扫描概要",-1)),(0,n.Lk)("div",bt,[(0,n.Lk)("p",null,[e[20]||(e[20]=(0,n.Lk)("strong",null,"扫描目标:",-1)),(0,n.eW)(" "+(0,y.v_)(o.generatedReport.scanTargets),1)]),(0,n.Lk)("p",null,[e[21]||(e[21]=(0,n.Lk)("strong",null,"扫描时间:",-1)),(0,n.eW)(" "+(0,y.v_)(o.generatedReport.scanDuration)+" 秒",1)]),(0,n.Lk)("p",null,[e[22]||(e[22]=(0,n.Lk)("strong",null,"扫描工具:",-1)),(0,n.eW)(" "+(0,y.v_)(o.generatedReport.scanTools),1)]),(0,n.Lk)("p",null,[e[23]||(e[23]=(0,n.Lk)("strong",null,"严重漏洞详情:",-1)),(0,n.eW)(" "+(0,y.v_)(o.generatedReport.criticalVulnsDescription),1)])])])])])])}var Ct=a(953),_t=a(163);const Et={name:"ReportGenerator",props:{reportTemplates:{type:Array,default:()=>[{id:"std",value:"standard",name:"标准模板"},{id:"pro",value:"professional",name:"专业模板"}]}},setup(){const t=(0,Ct.KR)([]),e=()=>{try{const e=a(5961);t.value=e.keys().map((t=>e(t))).sort(((t,e)=>e.id.localeCompare(t.id))),t.value.length>0&&(o.value=t.value[0].id)}catch(e){console.error(e),_t.nk.error("加载扫描记录失败")}};(0,n.sV)(e);const s=(0,Ct.KR)("standard"),o=(0,Ct.KR)(null),r=(0,Ct.KR)("系统管理员"),l=(0,Ct.KR)((new Date).toLocaleDateString()),i=(0,Ct.Kh)({scanType:"",scanTargets:"",scanTools:"",vulnCount:{critical:0,high:0,medium:0,low:0},scanDuration:0,criticalVulnsDescription:"请选择扫描记录"});(0,n.wB)(o,(e=>{if(!e)return void Object.assign(i,{scanType:"",scanTargets:"",scanTools:"",vulnCount:{critical:0,high:0,medium:0,low:0},scanDuration:0,criticalVulnsDescription:"请选择扫描记录"});const a=t.value.find((t=>t.id===e));if(!a)return void _t.nk.error("扫描记录不存在");if(a.vulnSummary)i.vulnCount={...a.vulnSummary};else{const t={critical:0,high:0,medium:0,low:0};a.vulnerabilities?.forEach((e=>{e.severity&&t[e.severity]++})),i.vulnCount=t}i.scanType=a.targets?.length?"Web扫描":a.scanDepth?"二进制扫描":"未指定";const s=a.vulnerabilities?.filter((t=>"critical"===t.severity)).map((t=>t.name))||[];i.criticalVulnsDescription=s.length?s.join("、"):"未发现严重漏洞",i.scanTargets=a.targets?.join(", ")||"未指定扫描目标",i.scanTools=a.selectedPlugins?.join(", ")||"未指定扫描工具",i.scanDuration=a.duration||0}));const c=()=>{o.value?_t.nk.success(`"${s.value}"报告生成完成`):_t.nk.warning("请选择扫描记录")},u=()=>{i.scanType?_t.nk.success("报告已保存"):_t.nk.warning("请先生成报告")},d=()=>{i.scanType?_t.nk.success("报告已导出"):_t.nk.warning("请先生成报告")},p=()=>{i.scanType?_t.nk.success("报告已分享"):_t.nk.warning("请先生成报告")};return{scanHistory:t,selectedReportTemplate:s,selectedRecordId:o,reporterName:r,currentDate:l,generatedReport:i,generateReport:c,saveReport:u,exportReport:d,shareReport:p}}},xt=(0,i.A)(Et,[["render",Tt],["__scopeId","data-v-2158d252"]]),Rt=xt,wt={name:"Dashboard",components:{ScanTarget:j,ScanStatus:tt,ReportGenerator:Rt}},Ot=(0,i.A)(wt,[["render",f],["__scopeId","data-v-30a6b7e2"]]),At=Ot,Dt=[{path:"/",redirect:"/dashboard"},{path:"/dashboard",name:"Dashboard",component:At},{path:"/scan-history",name:"ScanHistory",component:()=>a.e(608).then(a.bind(a,4608))},{path:"/report-templates",name:"ReportTemplates",component:()=>a.e(798).then(a.bind(a,798))}],Nt=(0,d.aE)({history:(0,d.LA)("/"),routes:Dt}),Pt=Nt;var It=a(6278);const Ut=(0,It.y$)({strict:!1,state:{currentScan:{status:"idle",progress:0,targets:[],requirements:"",selectedPlugins:[],scanDepth:5,vulnerabilities:[],startTime:null,endTime:null,error:null},validationTools:[{id:1,name:"ExploitDB 验证",value:"exploitdb"},{id:2,name:"自定义验证脚本",value:"custom"},{id:3,name:"MCP 验证框架",value:"mcp",disabled:!0}],plugins:[{id:1,name:"SQLMap (SQL 注入检测)",value:"sqlmap"},{id:2,name:"OWASP ZAP (综合扫描)",value:"zap"},{id:3,name:"NMAP (端口与服务扫描)",value:"nmap"},{id:4,name:"Dirsearch (目录扫描)",value:"dirb"}],scanHistory:[]},mutations:{SET_SCAN_TARGETS(t,e){t.currentScan.targets=e},SET_SCAN_REQUIREMENTS(t,e){t.currentScan.requirements=e},SET_SELECTED_PLUGINS(t,e){t.currentScan.selectedPlugins=e},SET_SCAN_DEPTH(t,e){t.currentScan.scanDepth=e},START_SCAN(t){t.currentScan={...t.currentScan,status:"scanning",progress:0,vulnerabilities:[],startTime:new Date,endTime:null,error:null}},UPDATE_SCAN_PROGRESS(t,e){t.currentScan.progress=e},COMPLETE_SCAN(t,e){const a={...t.currentScan,status:"completed",progress:100,vulnerabilities:e,endTime:new Date};t.currentScan=a;const s=JSON.parse(JSON.stringify(a));s.id=Date.now().toString(),t.scanHistory.unshift(s),t.scanHistory.length>50&&t.scanHistory.pop()},SET_SCAN_FAILED(t,e){t.currentScan={...t.currentScan,status:"failed",error:e,endTime:new Date}},SET_SCAN_CANCELLED(t){t.currentScan={...t.currentScan,status:"cancelled",endTime:new Date}}},actions:{async startScan({commit:t,state:e}){t("START_SCAN");let a=setInterval((()=>{"cancelled"!==e.currentScan.status?t("UPDATE_SCAN_PROGRESS",Math.min(e.currentScan.progress+5,95)):clearInterval(a)}),500);try{const a=[{id:"vuln-1",name:"SQL 注入漏洞",target:e.currentScan.targets[0]||"http://example.com/login",severity:"critical",cve:"CVE-2023-12345",description:"在登录接口发现 SQL 注入漏洞",status:"pending"},{id:"vuln-2",name:"跨站脚本漏洞 (XSS)",target:e.currentScan.targets[0]||"http://example.com/feedback",severity:"high",cve:"CVE-2023-54321",description:"在用户反馈表单中发现存储型 XSS 漏洞",status:"pending"}];t("COMPLETE_SCAN",a)}catch(s){t("SET_SCAN_FAILED",s.message)}finally{clearInterval(a)}},cancelScan({commit:t}){t("SET_SCAN_CANCELLED")}},getters:{scanDuration:t=>{if(!t.currentScan.startTime)return 0;const e=t.currentScan.endTime||new Date;return Math.round((e-t.currentScan.startTime)/1e3)},firstTarget:t=>t.currentScan.targets?.[0]||"N/A"}});var jt=a(8284);a(4188);const Ft=(0,s.Ef)(u);Ft.use(jt.A),Ft.use(Ut),Ft.use(Pt),Ft.mount("#app")}},e={};function a(s){var n=e[s];if(void 0!==n)return n.exports;var o=e[s]={exports:{}};return t[s].call(o.exports,o,o.exports,a),o.exports}a.m=t,(()=>{var t=[];a.O=(e,s,n,o)=>{if(!s){var r=1/0;for(u=0;u<t.length;u++){for(var[s,n,o]=t[u],l=!0,i=0;i<s.length;i++)(!1&o||r>=o)&&Object.keys(a.O).every((t=>a.O[t](s[i])))?s.splice(i--,1):(l=!1,o<r&&(r=o));if(l){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[s,n,o]}})(),(()=>{a.d=(t,e)=>{for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}})(),(()=>{a.f={},a.e=t=>Promise.all(Object.keys(a.f).reduce(((e,s)=>(a.f[s](t,e),e)),[]))})(),(()=>{a.u=t=>"js/"+t+"."+{608:"0eb0b574",798:"a2e9b35f"}[t]+".js"})(),(()=>{a.miniCssF=t=>"css/"+t+"."+{608:"b2ebad8a",798:"12e9dc72"}[t]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{var t={},e="vue_script:";a.l=(s,n,o,r)=>{if(t[s])t[s].push(n);else{var l,i;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==e+o){l=d;break}}l||(i=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",e+o),l.src=s),t[s]=[n];var p=(e,a)=>{l.onerror=l.onload=null,clearTimeout(v);var n=t[s];if(delete t[s],l.parentNode&&l.parentNode.removeChild(l),n&&n.forEach((t=>t(a))),e)return e(a)},v=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),i&&document.head.appendChild(l)}}})(),(()=>{a.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}})(),(()=>{a.p="/"})(),(()=>{if("undefined"!==typeof document){var t=(t,e,s,n,o)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",a.nc&&(r.nonce=a.nc);var l=a=>{if(r.onerror=r.onload=null,"load"===a.type)n();else{var s=a&&a.type,l=a&&a.target&&a.target.href||e,i=new Error("Loading CSS chunk "+t+" failed.\n("+s+": "+l+")");i.name="ChunkLoadError",i.code="CSS_CHUNK_LOAD_FAILED",i.type=s,i.request=l,r.parentNode&&r.parentNode.removeChild(r),o(i)}};return r.onerror=r.onload=l,r.href=e,s?s.parentNode.insertBefore(r,s.nextSibling):document.head.appendChild(r),r},e=(t,e)=>{for(var a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var n=a[s],o=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(o===t||o===e))return n}var r=document.getElementsByTagName("style");for(s=0;s<r.length;s++){n=r[s],o=n.getAttribute("data-href");if(o===t||o===e)return n}},s=s=>new Promise(((n,o)=>{var r=a.miniCssF(s),l=a.p+r;if(e(r,l))return n();t(s,l,null,n,o)})),n={524:0};a.f.miniCss=(t,e)=>{var a={608:1,798:1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=s(t).then((()=>{n[t]=0}),(e=>{throw delete n[t],e})))}}})(),(()=>{var t={524:0};a.f.j=(e,s)=>{var n=a.o(t,e)?t[e]:void 0;if(0!==n)if(n)s.push(n[2]);else{var o=new Promise(((a,s)=>n=t[e]=[a,s]));s.push(n[2]=o);var r=a.p+a.u(e),l=new Error,i=s=>{if(a.o(t,e)&&(n=t[e],0!==n&&(t[e]=void 0),n)){var o=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.src;l.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",l.name="ChunkLoadError",l.type=o,l.request=r,n[1](l)}};a.l(r,i,"chunk-"+e,e)}},a.O.j=e=>0===t[e];var e=(e,s)=>{var n,o,[r,l,i]=s,c=0;if(r.some((e=>0!==t[e]))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(i)var u=i(a)}for(e&&e(s);c<r.length;c++)o=r[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(u)},s=self["webpackChunkvue_script"]=self["webpackChunkvue_script"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var s=a.O(void 0,[504],(()=>a(6296)));s=a.O(s)})();
//# sourceMappingURL=app.7d2e1577.js.map